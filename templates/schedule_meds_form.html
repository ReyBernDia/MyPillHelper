{% extends 'base.html' %}

{% block title %}Schedule your Medication{% endblock %}


{% block content %}

  <div>
    <h2>Scheduling Text Reminders for {{ med_strength }}</h2>
      <form action="/schedule_med" id="settings" method="POST">
        <h3>When do you want to recieve your text notifications?</h3>
          <label for="AM_time">Morning Notification:</label>
          <input type="time" id="AM_time" name="AM_time" min="05:00" max="10:00" required>
          <label for="Mid_time">Mid-day Notification:</label>
          <input type="time" id="Mid_time" name="Mid_time" min="9:00" max="14:00" required>
          <label for="PM_time">Evening Notification:</label>
          <input type="time" id="PM_time" name="PM_time" min="17:00" max="22:00" required>
        <h3>We need more information about your prescription to send you notifications.</h3>
        <p>This information can be found on your prescription lable.</p>
          <label for="duration">Prescription Duration (in days):</label>
          <input type="number" id="duration" name="duration" required>
          <label for="qty">Quantity Prescribed:</label>
          <input type="number" id="qty" name="qty" value=30>
          <label for="refills">Refills:</label>
          <input type="number" id="refills" name="refills" value=1>
          <input type="hidden" name="med_strength" value="{{med_strength}}">
          <input type="hidden" name="med_id" value="{{med_id}}">
        <input type="submit" value="Schedule Medication">
      </form>
  </div>

{% endblock %}
<script>

    document.addEventListener('DOMContentLoaded', () => {
        $('#submit_schedule').on('click', submit_med_info)
    });

    function submit_med_info() {
        console.log('hii')
        const med_name = document.getElementById("#med_name");
        const med_strength = document.getElementById("#individual_strength");

        const entry = {
            med_name: med_name.value,
            med_strength: med_strength.value
        };

        fetch(`${window.origin}/show_schedule_form`, {
            method: "POST",
            credentials: "include",
            body: JSON.stringify(entry),
            cache: "no-cache",
            headers: new Headers({
              "content-type": "application/json"
            })
          })
          .then(function(response) {
            if (response.status !== 200) {
              console.log(`Looks like there was a problem. Status code: ${response.status}`);
              return;
            }
            response.json().then(function(data) {
              console.log(data);
            });
          })
          .catch(function(error) {
            console.log("Fetch error: " + error);
        });
    };

</script>

